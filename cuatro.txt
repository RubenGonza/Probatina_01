MODIFICADO por fariiddd y alfredo